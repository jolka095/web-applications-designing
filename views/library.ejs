<!DOCTYPE html>
<html>
<head>
    <%- include('header.ejs') %>
</head>
<body class>
    <%if (user) { %>
    <%- include('navbar.ejs') %>
    <% } else { %>
    <%- include('navbar1.ejs') %>
    <% } %>

    <div class="container text-left">
        <br>
        <br>
        <h2>Moja biblioteczka</h2>
        <%if (typeof booksArr === 'undefined' && booksArr === null) { %>
            <h4> Biblioteczka jest <strong> pusta </strong>- przejdź do <a href="/catalog"> katalogu.</a></h4>
        <% } else {
            in_reading = 0;
            read = 0;
            to_read = 0; }%>
        <br>
        <br>
        <div class="panel with-nav-tabs panel-info" role="tablist">

            <ul class="nav nav-tabs" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" href="#czytam" role="tab" data-toggle="tab"> Teraz czytam </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#chce" role="tab" data-toggle="tab"> Chcę przeczytać </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#przeczytane" role="tab" data-toggle="tab"> Przeczytane </a>
                </li>
            </ul> <!-- end of tablist -->


            <div class=" panel-body tab-content text-left">

                <div id="czytam" role="tabpanel" class="tab-pane fade active show">
                    <br>
                    <%if (typeof booksArr !== 'undefined' && booksArr !== null){ %>
                        <div class="books_container">
                            <div class="card-deck-wrapper">
                                <div class="card-deck">
                                    <% booksArr.forEach( (book) => { %>
                                        <%if (book.status.stat === 'reading' ) {
                                            in_reading = in_reading + 1;
                                            %>

                                            <div class="card text-center">
                                                <br>
                                                <%if (user) { %> <a href="/book_read/<%= book.details.idBook %>"  title="Czytaj >>">
                                                    <img class="card-img-top img-fluid mx-auto d-block" src="/<%= book.details.image %>" alt="<%= book.details.book + " " + ' image' %>">
                                                </a> %> <% } else { %>
                                                <img class="card-img-top img-fluid mx-auto d-block" src="/<%= book.details.image %>" alt="<%= book.details.book + " " + ' image' %>">
                                                <% } %>
                                                <div class="card-body d-flex flex-column">
                                                    <p class="card-text">
                                                        <strong> <i> <%= book.details.book %> </i> </strong>
                                                        <br>
                                                        <a href="/authors/<%= book.author.idAuthor  %>/<%= book.author.name + " " + book.author.surname %>">
                                                            <%= book.author.name + " " + book.author.surname  %>
                                                        </a>
                                                    </p>
                                                    <a href="<%= '/book_profile/'+ book.details.idBook %>" class="btn btn-info btn-block mt-auto"> Więcej </a>
                                                </div>
                                            </div>

                                        <% } %>
                                    <% })
                                     if (in_reading == 0) {%>
                                        <h5> Nie czytasz aktualnie żadnej książki. </h5>
                                        <br><br><br>
                                    <% } %>

                                </div>
                            </div>
                        </div>
                    <% } else { %>
                        <h5> Nie czytasz aktualnie żadnej książki. </h5>
                    <% } %>
                </div> <!-- end of 'czytam' -->

                <div id="chce" role="tabpanel" class="tab-pane fade">
                    <br>
                    <%if (typeof booksArr !== 'undefined' && booksArr !== null){ %>
                    <div class="books_container">
                        <div class="card-deck-wrapper">
                            <div class="card-deck">
                                <% booksArr.forEach( (book) => { %>
                                <%if (book.status.stat === "to_read" ) {
                                    to_read = to_read + 1;
                                %>

                                <div class="card text-center">
                                    <br>
                                    <%if (user) { %> <a href="/book_read/<%= book.details.idBook %>"  title="Czytaj >>">
                                        <img class="card-img-top img-fluid mx-auto d-block" src="/<%= book.details.image %>" alt="<%= book.details.book + " " + ' image' %>">
                                    </a> %> <% } else { %>
                                    <img class="card-img-top img-fluid mx-auto d-block" src="/<%= book.details.image %>" alt="<%= book.details.book + " " + ' image' %>">
                                    <% } %>
                                    <div class="card-body d-flex flex-column">
                                        <p class="card-text">
                                            <strong> <i> <%= book.details.book %> </i> </strong>
                                            <br>
                                            <a href="/authors/<%= book.author.idAuthor  %>/<%= book.author.name + " " + book.author.surname %>">
                                                <%= book.author.name + " " + book.author.surname  %>
                                            </a>
                                        </p>
                                        <a href="<%= '/book_profile/'+ book.details.idBook %>" class="btn btn-info btn-block mt-auto"> Więcej </a>
                                    </div>
                                </div>

                                <% } %>
                                <% })
                                if (to_read == 0) {%>
                                <h5> Brak książek do przeczytania.</h5>
                                <br><br><br>
                                <% } %>

                            </div>
                        </div>
                    </div>
                    <% } else { %>
                        <h5> Brak książek do przeczytania.</h5>
                    <% } %>
                </div> <!-- end of 'chce' -->

                <div id="przeczytane" role="tabpanel" class="tab-pane fade">
                    <br>
                    <%if (typeof booksArr !== 'undefined' && booksArr !== null){ %>
                    <div class="books_container">
                        <div class="card-deck-wrapper">
                            <div class="card-deck">
                                <% booksArr.forEach( (book) => { %>
                                <%if (book.status.stat === 'done' ) {
                                    read = read + 1;
                                %>

                                <div class="card text-center">
                                    <br>
                                    <%if (user) { %> <a href="/book_read/<%= book.details.idBook %>"  title="Czytaj >>">
                                        <img class="card-img-top img-fluid mx-auto d-block" src="/<%= book.details.image %>" alt="<%= book.details.book + " " + ' image' %>">
                                    </a> %> <% } else { %>
                                    <img class="card-img-top img-fluid mx-auto d-block" src="/<%= book.details.image %>" alt="<%= book.details.book + " " + ' image' %>">
                                    <% } %>
                                    <div class="card-body d-flex flex-column">
                                        <p class="card-text">
                                            <strong> <i> <%= book.details.book %> </i> </strong>
                                            <br>
                                            <a href="/authors/<%= book.author.idAuthor  %>/<%= book.author.name + " " + book.author.surname %>">
                                                <%= book.author.name + " " + book.author.surname  %>
                                            </a>
                                        </p>
                                        <a href="<%= '/book_profile/'+ book.details.idBook %>" class="btn btn-info btn-block mt-auto"> Więcej </a>
                                    </div>
                                </div>

                                <% } %>
                                <% })
                                if (read == 0) {%>
                                <h5> Nie przeczytałeś jeszcze żadnej książki.</h5>
                                <br><br><br>
                                <% } %>
                            </div>
                        </div>
                    </div>
                    <% } else { %>
                    <h5> Nie przeczytałeś jeszcze żadnej książki.</h5>
                    <% } %>
                </div> <!-- end of przeczytane -->
            </div>  <!-- end of panel-body -->

        </div>
    </div>
    <%- include('footer.ejs') %>
</body>
</html>