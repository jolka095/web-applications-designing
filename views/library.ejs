<!DOCTYPE html>
<html>
<head>
    <%- include('header.ejs') %>
</head>
<body>
    <%if (user) { %> <%- include('navbar.ejs') %> <% } else { %> <%- include('navbar1.ejs') %> <% } %>

    <div class="container text-left">
        <br>
        <br>
        <h2>Moja biblioteczka</h2>
        <%if (typeof booksArr == "undefined" || booksArr == null) { %>
            <h4> Biblioteczka jest <strong> pusta </strong>- przejdź do <a href="/catalog"> katalogu.</a></h4>
        <% } else { 
            var to_read = 0;
            var reading = 0;
            var done = 0; 
        } %>
        <br>
        <br>
        <div class="panel with-nav-tabs panel-info" role="tablist">

            <ul class="nav nav-tabs" role="tablist">
                <li class="nav-item"> <a class="nav-link active" href="#czytam" role="tab" data-toggle="tab">   Teraz czytam        </a> </li>
                <li class="nav-item"> <a class="nav-link" href="#chce" role="tab" data-toggle="tab">            Chcę przeczytać     </a> </li>
                <li class="nav-item"> <a class="nav-link" href="#przeczytane" role="tab" data-toggle="tab">     Przeczytane         </a> </li>
            </ul> <!-- end of tablist -->

            <div class=" panel-body tab-content text-left">

                <div id="czytam" role="tabpanel" class="tab-pane fade active show">
                    <br>
                    <% if (typeof booksArr !== "undefined" && booksArr !== null) { %>
                        <div class="books_container">
                            <div class="card-deck-wrapper">
                                <div class="card-deck">
                                    <% booksArr.forEach( (book) => { %>
                                        <% if (book.status == "reading") { 
                                            reading++; %>
                                            <div class="card ">
                                                <br>
                                                <a href="/book_read/<%= book.details.idBook %>" title="Czytaj >>">
                                                    <img class="card-img-top img-fluid mx-auto d-block" src="/<%= book.details.image %>" alt="<%= book.details.book + ' image' %>">
                                                </a> %>
            
                                                <div class="card-body d-flex flex-column">
                                                    <p class="card-text text-center">
                                                        <strong> <i> <%= book.details.book %> </i> </strong>
                                                        <br>
                                                        <a href="/authors/<%= book.author.idAuthor %>/<%= book.author.name + " " + book.author.surname  %>">
                                                            <%= book.author.name + " " + book.author.surname %>
                                                        </a>
                                                    </p>
                                                    <a href="<%= '/book_profile/'+ book.details.idBook %>" class="btn btn-info btn-block mt-auto"> Więcej </a>
                                                </div>
                                            </div>
                                        <% } %>
                                    <% })
                                    if(reading == 0) { %>
                                        <h5> Nie czytasz aktualnie żadnej książki. </h5>
                                    <% } %>
                                </div>  <!-- card-deck END -->
                            </div> <!-- card-deck-wrapper END -->
                        </div> <!-- book container END -->  
                    <% } %>
                </div> <!-- end of 'czytam' -->


                <div id="chce" role="tabpanel" class="tab-pane fade">
                    <br>
                    <% if (typeof booksArr !== "undefined" && booksArr !== null) { %>
                        <div class="books_container">
                            <div class="card-deck-wrapper">
                                <div class="card-deck">

                                    <% booksArr.forEach( (book) => { %>
                                        <% if (book.status == "to_read") { 
                                            to_read++; %>
                                            <div class="card ">
                                                <br>
                                                <a href="/book_read/<%= book.details.idBook %>" title="Czytaj >>">
                                                    <img class="card-img-top img-fluid mx-auto d-block" src="/<%= book.details.image %>" alt="<%= book.details.book + ' image' %>">
                                                </a> %>
            
                                                <div class="card-body d-flex flex-column">
                                                    <p class="card-text text-center">
                                                        <strong> <i> <%= book.details.book %> </i> </strong>
                                                        <br>
                                                        <a href="/authors/<%= book.author.idAuthor %>/<%= book.author.name + " " + book.author.surname  %>">
                                                            <%= book.author.name + " " + book.author.surname %>
                                                        </a>
                                                    </p>
                                                    <a href="<%= '/book_profile/'+ book.details.idBook %>" class="btn btn-info btn-block mt-auto"> Więcej </a>
                                                </div>
                                            </div>
                                        <% } %>
                                    <% }) 
                                    
                                    if(to_read == 0) { %>
                                        <h5> Brak książek do przeczytania.</h5>
                                    <% } %>
                                </div>  <!-- card-deck END -->
                            </div> <!-- card-deck-wrapper END -->
                        </div> <!-- book container END -->                  
                    <% } %>
                </div> <!-- end of 'chce' -->


                <div id="przeczytane" role="tabpanel" class="tab-pane fade">
                    <br>
                    <% if (typeof booksArr !== "undefined" && booksArr !== null) { %>
                        <div class="books_container">
                            <div class="card-deck-wrapper">
                                <div class="card-deck">
                                    <% booksArr.forEach( (book) => { %>
                                        <% if (book.status == "done") {
                                            done++; %>
                                            <div class="card ">
                                                <br>
                                                <a href="/book_read/<%= book.details.idBook %>" title="Czytaj >>">
                                                    <img class="card-img-top img-fluid mx-auto d-block" src="/<%= book.details.image %>" alt="<%= book.details.book + ' image' %>">
                                                </a> %>
            
                                                <div class="card-body d-flex flex-column">
                                                    <p class="card-text text-center">
                                                        <strong> <i> <%= book.details.book %> </i> </strong>
                                                        <br>
                                                        <a href="/authors/<%= book.author.idAuthor %>/<%= book.author.name + " " + book.author.surname  %>">
                                                            <%= book.author.name + " " + book.author.surname %>
                                                        </a>
                                                    </p>
                                                    <a href="<%= '/book_profile/'+ book.details.idBook %>" class="btn btn-info btn-block mt-auto"> Więcej </a>
                                                </div>
                                            </div>
                                        <% } %>
                                    <% });
                                    
                                    if(done == 0) { %>
                                        <h5> Nie przeczytałeś jeszcze żadnej książki.</h5>
                                    <% } %>
                                </div>  <!-- card-deck END -->
                            </div> <!-- card-deck-wrapper END -->
                        </div> <!-- book container END -->
                    <% } %>
                </div> <!-- end of przeczytane -->

                
            </div>  <!-- end of panel-body -->
        </div> <!-- end of panel-info tablist -->
    </div>
    <%- include('footer.ejs') %>
</body>
</html>